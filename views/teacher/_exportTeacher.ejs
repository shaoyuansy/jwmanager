<link rel="stylesheet" href="/css/exportteacher.css">

<div class="content-wrapper">
    <section class="content-header">
        <h1><%= title %></h1>
        <ol class="breadcrumb">
            <li><a href="/index"><i class="fa fa-home"></i> 首页</a></li>
            <li class="active">教师资料导出预览</li>
        </ol>
    </section>
    <section class="content">
        <div class="box">
            <div class="box-header">
                <h3 class="box-title">教师资料导出预览</h3>
                <div class="box-tools pull-right">
                    <button type="button" title="导出" class="btn btn-box-tool"
                            onclick="toExcel();">
                        <i class="fa fa-fw fa-cloud-download"></i>导出
                    </button>
                </div>
                <div class="box box-default box-solid" style="margin-top:10px;">
                    <div class="box-header with-border" style="padding:3px;font-size:14px;">
                        <h3 class="box-title" style="font-size:14px;">当前显示的列</h3>
                        <div class="box-tools pull-right" style="top: 1px;">
                            <button type="button" style="padding:0px;line-height:0px" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="box-body">
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="0" /> 工号 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="1" /> 姓名 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="2" /> 性别 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="3" /> 出生年月 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="4" /> 民族 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="5" /> 身份证号码 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="6" /> 联系电话 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="7" /> 所属教研室 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="8" /> 入校时间 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="9" /> 分管负责人 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="10" /> 定职时间 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="11" /> 任职状态 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="12" /> 单位号 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="13" /> 单位名称 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="14" /> 工作单位类别 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="15" /> 学历 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="16" /> 最高学位 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="17" /> 是否专任 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="18" /> 毕业时间 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="19" /> 毕业院校 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="20" /> 学缘 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="21" /> 专业技术职称 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="22" /> 学科类别 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="23" /> 导师类型 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="24" /> 地区 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="25" /> 可授课程 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="26" /> 在我院初始代课时间 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="27" /> 教学效果|</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="28" /> 是否为双师型 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="29" /> 是否具有工程背景 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="30" /> 是否具有行业背景 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="31" /> 身份证复印件 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="32" /> 工作证复印件 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="33" /> 教师资格证复印件 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="34" /> 学位证复印件 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="35" /> 毕业证复印件 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="36" /> 职称证复印件 |</span>
                        <span><input id="checkshow" name="checkshow" type="checkbox" value="37" /> 协议书 |</span>
                        <!--<span><input id="checkshow" name="checkshow" type="checkbox" value="38" /> 附件 |</span>-->
                    </div>
                </div>
                <div class="box-body">
                    <table id="exporttable" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>工号</th>
                                <th>姓名</th>
                                <th>性别</th>
                                <th>出生年月</th>
                                <th>民族</th>
                                <th>身份证号码</th>
                                <th>联系电话</th>
                                <th>所属教研室</th>
                                <th>入校时间</th>
                                <th>分管负责人</th>
                                <th>定职时间</th>
                                <th>任职状态</th>
                                <th>单位号</th>
                                <th>单位名称</th>
                                <th>工作单位类别</th>
                                <th>学历</th>
                                <th>最高学位</th>
                                <th>是否专任</th>
                                <th>毕业时间</th>
                                <th>毕业院校</th>
                                <th>学缘</th>
                                <th>专业技术职称</th>
                                <th>学科类别</th>
                                <th>导师类型</th>
                                <th>地区</th>
                                <th>可授课程</th>
                                <th>在我院初始代课时间</th>
                                <th>教学效果</th>
                                <th>是否为双师型</th>
                                <th>是否具有工程背景</th>
                                <th>是否具有行业背景</th>
                                <th>身份证复印件</th>
                                <th>工作证复印件</th>
                                <th>教师资格证复印件</th>
                                <th>学位证复印件</th>
                                <th>毕业证复印件</th>
                                <th>职称证复印件</th>
                                <th>协议书</th>
                                <!--<th>附件</th>-->
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </section>
</div>

<script src="/javascripts/mydatatable.js"></script>
<script src="/table2excel/jquery.table2excel.js"></script>
<script>
    $(document).ready(function () {
        var columns = [
            {
                "data": "GH",
                "className": "text_center"
            },
            {
                "data": "XM",
                "className": "text_center"
            },
            {
                "data": "XB",
                "className": "text_center"
            },
            {
                "data": "CSNY",
                "className": "text_center"
            },
            {
                "data": "MZ",
                "className": "text_center"
            },
            {
                "data": "SFZHM",
                "className": "text_center"
            },
            {
                "data": "LXDH",
                "className": "text_center"
            },
            {
                "data": "JYSMC",
                "className": "text_center"
            },
            {
                "data": "RXSJ",
                "className": "text_center"
            },
            {
                "data": "FGFZR",
                "className": "text_center"
            },
            {
                "data": "DZSJ",
                "className": "text_center"
            },
            {
                "data": "RZZT",
                "className": "text_center"
            },
            {
                "data": "DWH",
                "className": "text_center"
            },
            {
                "data": "DWMC",
                "className": "text_center"
            },
            {
                "data": "GZDWLB",
                "className": "text_center"
            },
            {
                "data": "XL",
                "className": "text_center"
            },
            {
                "data": "ZGXW",
                "className": "text_center"
            },
            {
                "data": "SFZR",
                "className": "text_center"
            },
            {
                "data": "BYSJ",
                "className": "text_center"
            },
            {
                "data": "BYYX",
                "className": "text_center"
            },
            {
                "data": "XY",
                "className": "text_center"
            },
            {
                "data": "ZYJSZC",
                "className": "text_center"
            },
            {
                "data": "XKLB",
                "className": "text_center"
            },
            {
                "data": "DSLX",
                "className": "text_center"
            },
            {
                "data": "DQ",
                "className": "text_center"
            },
            {
                "data": "KSKC",
                "className": "text_center"
            },
            {
                "data": "CSDKSJ",
                "className": "text_center"
            },
            {
                "data": "JXXG",
                "className": "text_center"
            },
            {
                "data": "SFWSSX",
                "className": "text_center"
            },
            {
                "data": "SFJYGCBJ",
                "className": "text_center"
            },
            {
                "data": "SFJYHYBJ",
                "className": "text_center"
            },
            {
                "data": "SFSJSFZFYJ",
                "className": "text_center"
            },
            {
                "data": "SFSJGZZFYJ",
                "className": "text_center"
            },
            {
                "data": "SFSJJSZGZFYJ",
                "className": "text_center"
            },
            {
                "data": "SFSJXWZFYJ",
                "className": "text_center"
            },
            {
                "data": "SFSJBYZFYJ",
                "className": "text_center"
            },
            {
                "data": "SFSJZCZFYJ",
                "className": "text_center"
            },
            {
                "data": "SFSJXYS",
                "className": "text_center"
            }
            // {
            //     "className": "text_center",
            //     "data": function (obj) {
            //         var filep = obj.FJ;
            //         var str = "";
            //         if (filep == null || filep == "") {
            //             str += '无';
            //         }
            //         if (filep != "" && filep != null) {
            //             var locArray = filep.split("/");
            //             var fileNmae = locArray[locArray.length - 1];
            //             str += '<a href="/teacherService/download?filePath=' + filep + '" > ' + fileNmae + '</a>';
            //         }
            //         return str;
            //     }
            // }
        ];
        var mytable = ExportDataTable('#exporttable', '/teacherService/exportBySomeId?idstr=<%= idstr %>', columns);

        $('input[type="checkbox"][name="checkshow"]').each(function () {
            var column = $("#exporttable").DataTable().column($(this).val());
            this.checked = column.visible();
        });
        $('input[type="checkbox"][name="checkshow"]').change(function () {
            var column = $("#exporttable").DataTable().column($(this).val());
            column.visible(!column.visible());
        });
    });

    
    //导出
    function toExcel() {
        $("#exporttable").table2excel({
            exclude: ".noExl",//有class = “noExl” 的行不被导出；
            name: "Excel Document Name",
            filename: "教师信息表" + "-" + GetTimeStr(),
            exclude_img: true,
            exclude_links: true,
            exclude_inputs: true
        })
    }
    
</script>