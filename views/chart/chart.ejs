<script type="text/javascript" src="/chart/highcharts.js"></script>
<script type="text/javascript" src="/chart/exporting.js"></script>

<!-- 页面内容 content -->
<div class="content-wrapper">
    <!-- 页面内容 Header -->
    <section class="content-header">
        <h1>
            信息统计页面
        </h1>
        <ol class="breadcrumb">
            <li><a href="/index"><i class="fa fa-home"></i> 首页</a></li>
            <li class="active">信息统计</li>
        </ol>
    </section>

    <!-- Main content -->
    <section class="content">
        <!-- /.box -->

        <div class="box">
            <div class="box-header">
                <h3 class="box-title">信息统计</h3>

            </div>
            <!-- /.box-header -->
            <div class="box-body">
                <div id="container" style="min-width:700px;height:400px"></div>

            </div>
            <!-- /.box-body -->
        </div>
        <!-- /.box -->
    </section>
    <!-- /.content -->


</div>


<script>
    var jiaoshouArr = new Array();//教授
    var fujiaoshouArr = new Array();//副教授
    var jiangshiArr = new Array();//讲师
    var zhujiaoArr = new Array();//助教
    var wpjArr = new Array();//未评级
    var mycategories = new Array();//图表分组
    $(document).ready(function () {
        mycategories = [
            '软件工程',
            '物联网工程',
            '数字媒体'
        ];
        getDataByJys("软件工程");
        getDataByJys("物联网工程");
        getDataByJys("数字媒体");
    });
    //由教研室名称进行绘图
    function getDataByJys(jysmc){
        $.ajax({
            type: "get",
            url: '/chart/getListByJys',
            data:{JYSMC:jysmc},
            cache: true,
            success: function (msg) {
                var jiaoshou = 0, fujiaoshou = 0, jiangshi = 0, zhujiao = 0, wpj = 0;
                for (var i = 0; i < msg.data.length; i++) {
                    var zyjszc = msg.data[i].专业技术职称;
                    switch (zyjszc){
                        case '教授':
                            jiaoshou = msg.data[i].人数;
                            break;
                        case '副教授':
                            fujiaoshou = msg.data[i].人数;
                            break;
                        case '讲师':
                            jiangshi = msg.data[i].人数;
                            break;
                        case '助教':
                            zhujiao = msg.data[i].人数;
                            break;
                        case '其他正高级':
                            jiaoshou = msg.data[i].人数;
                            break;
                        case '其他副高级':
                            fujiaoshou = msg.data[i].人数;
                            break;
                        case '其他中级':
                            jiangshi = msg.data[i].人数;
                            break;
                        case '其他初级':
                            zhujiao = msg.data[i].人数;
                            break;
                        case '未评级':
                            wpj = msg.data[i].人数;
                            break;
                    }
                }
                //将各类的人数放到各类数组中
                jiaoshouArr.push(jiaoshou);
                fujiaoshouArr.push(fujiaoshou);
                jiangshiArr.push(jiangshi);
                zhujiaoArr.push(zhujiao);
                wpjArr.push(wpj);
                if(jysmc == "数字媒体"){
                    painting();
                }
            },
            error: function (e) {
                console.log(e);
            }
        });
    }
    //绘图
    function painting(){
        $('#container').highcharts({
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            subtitle: {
                text: '教研室各职称教师个数'
            },
            xAxis: {
                categories: mycategories
            },
            yAxis: {
                min: 0,
                title: {
                    text: '数目 (个)'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y} 个</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
            series: [{
                name: '教授（包括其他正高级）',
                data: jiaoshouArr
                //data: jiaoshouArr.concat(qtzgjArr)

            }, {
                name: '副教授（包括其他副高级）',
                data: fujiaoshouArr
                //data: fujiaoshouArr.concat(qtfgjArr)

            }, {
                name: '讲师（包括其他中级）',
                data: jiangshiArr
                //data: jiangshiArr.concat(qtzjArr)

            }, {
                name: '助教（包括其他初级）',
                data: zhujiaoArr
                //data: zhujiaoArr.concat(qtcjArr)

            }, {
                name: '未评级',
                data: wpjArr

            }]
        });
    }
</script>